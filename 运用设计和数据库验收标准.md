# 五、运用设计
## 5.1系统安全设计
### 5.1.1验证登录
> 小程序可以通过微信官方提供的登录能力方便地获取微信提供的用户身份标识，快速建立小程序内的用户体系
> 登录流程时序
![](https://img2022.cnblogs.com/blog/2836063/202204/2836063-20220430221608612-1908008446.jpg)
> 解释说明：调用 wx.login() 获取 临时登录凭证code ，并回传到开发者服务器。
> <font color="red">**特别注意：调用 auth.code2Session 接口，换取 用户唯一标识 OpenID 、 用户在微信开放平台帐号下的唯一标识UnionID（若当前小程序已绑定到微信开放平台帐号） 和 会话密钥 session_key。之后开发者服务器可以根据用户标识来生成自定义登录态，用于后续业务逻辑中前后端交互时识别用户身份。**
**会话密钥 session_key 是对用户数据进行 加密签名 的密钥。为了应用自身的数据安全，开发者服务器不应该把会话密钥下发到小程序，也不应该对外提供这个密钥。**
**临时登录凭证 code 只能使用一次。**</font>
### 5.1.2数据安全
> 利用微信小程序的安全规则要求前端发起的查询条件必须是安全规则的子集，否则拒绝访问。比如定义一个读写访问规则是 auth.openid == doc._openid，则表示访问时的查询条件（doc）的 openid 必须等于当前用户的 openid （由系统赋值的不可篡改的 auth.openid 给出），如果查询条件没有包含这项，则表示尝试越权访问 _openid 字段不等于自身的记录，会被后台拒绝访问。

### 5.2.2用户权限设计
> 1. 系统通过用户所授权的微信账号来进行登录，保证了账号的唯一性。
> 2. 管理员为最高的用户权限，可以对用户所发布的信息进行审查。
> 3. 具体的系统配置将根据系统实际运行情况做进一步的调整。


## 5.3数据库实施
### 5.3.1user
![](https://img2022.cnblogs.com/blog/2836063/202204/2836063-20220430222829894-2056057349.png)
### 5.3.2loseThing
![](https://img2022.cnblogs.com/blog/2836063/202204/2836063-20220430222945433-2103481703.png)
### 5.3.3seekThing
![](https://img2022.cnblogs.com/blog/2836063/202204/2836063-20220430222949469-1913982329.png)

# 六、数据库验证验收标准
|功能 | 验收标准 | 
|:--:|:--:|
| 数据的接受、更新 | 能够接受用户发布的寻物启事和失物招领的信息 | 
| 数据的查询 | 能够看到他人和自己所有的寻物启事和失物招领的信息 |
